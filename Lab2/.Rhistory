help("read.table")
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
setwd("/home/swpshadow/Documents/Bio/Lab2")
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
print(ad)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
dynamicmMods
cutree(hc1,k=3)  # hclust cluster labels
library(WGCNA)
dynamicMods = cutreeDynamic(dendro = hc1, distM = my.dist1,
deepSplit = 2, pamRespectsDendro = FALSE,
minClusterSize = 2)
names(dynamicMods) <- colnames(my.dist1)
dynamicColors = labels2colors(dynamicMods) # colors might not work
table(dynamicColors)
# Plot the dendrogram and colors underneath
sizeGrWindow(8,6)
plotDendroAndColors(hc1, dynamicColors, "Dynamic Tree Cut",
dendroLabels = NULL, hang = -1,
addGuide = TRUE, #guideHang = 0.05,
main = "dynamic cut clustering")
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -4,  # 2  (A-B)-C
), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$order <- 1:4              # order of leaves(trivial if hand-entered)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -4,  # 2  (A-B)-C
), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:4              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -4,  # 2  (A-B)-C
), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:2              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a <- list()
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -4,  # 2  (A-B)-C
), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:4              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a <- list()
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -4,  # 2  (A-B)-D
), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:4              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a <- list()
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -4  # 2  (A-B)-D
), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:4              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a <- list()
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -4  # 2  (A-B)-D
), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:4              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a <- list()
a$merge <- matrix(c(-1, -2,  1, -4), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:4              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
1:4
a <- list()
a$merge <- matrix(c(-1, -2,  1, -4), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- c(1,2,4, 3)             # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a <- list()
a$merge <- matrix(c(-1, -2,
1, -3), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:4             # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a <- list()  # initialize empty object
# define merging pattern:
#    negative numbers are leaves,
#    positive are merged clusters (defined by row number in $merge)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
a <- list()  # initialize empty object
# define merging pattern:
#    negative numbers are leaves,
#    positive are merged clusters (defined by row number in $merge)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
my.dist1 <- read.table("distance_matrix.txt",sep="\t", header=T)
rownames(my.dist1) = colnames(my.dist1)
my.dist1[lower.tri(my.dist1)] = t(my.dist1)[lower.tri(my.dist1)]
hc1 <- hclust(as.dist(my.dist1), method="average")
plot(hc1,hang=-1
cutree(hc1,k=3)  # hclust cluster labels
library(WGCNA)
dynamicMods = cutreeDynamic(dendro = hc1, distM = my.dist1,
deepSplit = 2, pamRespectsDendro = FALSE,
minClusterSize = 2)
names(dynamicMods) <- colnames(my.dist1)
a <- list()
a$merge <- matrix(c(-1, -2,
1, -3), ncol = 2, byrow=TRUE )
a$height <- c(.14, .305)    # define merge heights
a$order <- 1:4             # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:4]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
# make a tree by hand with R hclust
a <- list()  # initialize empty object
# define merging pattern:
#    negative numbers are leaves,
#    positive are merged clusters (defined by row number in $merge)
a$merge <- matrix(c(-1, -2,  # 1  A-B
1, -3,  # 2  (A-B)-C
-4, -5,  # 3 D-E
2,  3,  # 4 root ((A-B)-C)-(D-E)
4, -6   ), ncol = 2, byrow=TRUE )
a$height <- c(1, 2, 2, 3, 4)    # define merge heights
a$order <- 1:6              # order of leaves(trivial if hand-entered)
a$labels <- LETTERS[1:6]    # labels of leaves
class(a) <- "hclust"        # make it an hclust object
plot(a)                     # look at the result
#convert to a dendrogram object if needed
ad <- as.dendrogram(a)
setwd("/home/swpshadow/Documents/Bio/Lab2")
my.dist1 <- read.table("distance_matrix.txt",sep="\t", header=T)
rownames(my.dist1) = colnames(my.dist1)
my.dist1[lower.tri(my.dist1)] = t(my.dist1)[lower.tri(my.dist1)]
hc1 <- hclust(as.dist(my.dist1), method="average")
plot(hc1,hang=-1)
cutree(hc1,k=3)  # hclust cluster labels
library(WGCNA)
dynamicMods = cutreeDynamic(dendro = hc1, distM = my.dist1,
deepSplit = 2, pamRespectsDendro = FALSE,
minClusterSize = 2)
names(dynamicMods) <- colnames(my.dist1)
dynamicColors = labels2colors(dynamicMods) # colors might not work
table(dynamicColors)
# Plot the dendrogram and colors underneath
sizeGrWindow(8,6)
plotDendroAndColors(hc1, dynamicColors, "Dynamic Tree Cut",
dendroLabels = NULL, hang = -1,
addGuide = TRUE, #guideHang = 0.05,
main = "dynamic cut clustering")
b <- list()
b$merge <- matrix(c(-1, -2,
1, -3), ncol = 2, byrow=TRUE )
b$height <- c(.14, .305)    # define merge heights
b$order <- 1:4             # order of leaves(trivial if hand-entered)
b$labels <- LETTERS[1:4]    # labels of leaves
class(b) <- "hclust"        # make it an hclust object
plot(b)                     # look at the result
#convert to a dendrogram object if needed
bd <- as.dendrogram(b)
b <- list()
b$merge <- matrix(c(-1, -2,
1, -3,
2, -4), ncol = 2, byrow=TRUE )
b$height <- c(.14, .305, 0.51)    # define merge heights
b$order <- 1:4             # order of leaves(trivial if hand-entered)
b$labels <- LETTERS[1:4]    # labels of leaves
class(b) <- "hclust"        # make it an hclust object
plot(b)                     # look at the result
#convert to a dendrogram object if needed
bd <- as.dendrogram(b)
my.dist2 <- matrix(data=rep(0,16),ncol=4)
my.dist2[1,2]<-.14; my.dist2[1,3]<-.48; my.dist2[1,4]<-.33;
my.dist2[2,3]<-.50; my.dist2[2,4]<-.28;
my.dist2[3,4]<-.55;
# make matrix symmetric
# make the lower triangle equal to the upper triangle
my.dist2[lower.tri(my.dist2)] = t(my.dist2)[lower.tri(my.dist2)]
diag(my.dist2)<-999 # big number to guarantee it’s not the min
# compare with hclust
test <- hclust(as.dist(my.dist2), method="average") # average linkage, UPGMA
test$merge
test$height
test$order
test$labels<-LETTERS[1:4]
plot(test,hang=-1)
my.dist2 <- matrix(data=rep(0,16),ncol=4)
my.dist2[1,2]<-.14; my.dist2[1,3]<-.48; my.dist2[1,4]<-.33;
my.dist2[2,3]<-.50; my.dist2[2,4]<-.28;
my.dist2[3,4]<-.55;
# make matrix symmetric
# make the lower triangle equal to the upper triangle
my.dist2[lower.tri(my.dist2)] = t(my.dist2)[lower.tri(my.dist2)]
diag(my.dist2)<-999 # big number to guarantee it’s not the min
# compare with hclust
test <- hclust(as.dist(my.dist2), method="average") # average linkage, UPGMA
test$merge
test$height
test$order
test$labels<-LETTERS[1:4]
plot(test,hang=-1)
b <- list()
b$merge <- matrix(c(-1, -2,
1, -3,
2, -4), ncol = 2, byrow=TRUE )
b$height <- c(.14, .305, 0.51)    # define merge heights
b$order <- 1:4             # order of leaves(trivial if hand-entered)
b$labels <- LETTERS[1:4]    # labels of leaves
class(b) <- "hclust"        # make it an hclust object
plot(b)                     # look at the result
#convert to a dendrogram object if needed
bd <- as.dendrogram(b)
my.dist2 <- matrix(data=rep(0,16),ncol=4)
my.dist2[1,2]<-.14; my.dist2[1,3]<-.48; my.dist2[1,4]<-.33;
my.dist2[2,3]<-.50; my.dist2[2,4]<-.28;
my.dist2[3,4]<-.55;
# make matrix symmetric
# make the lower triangle equal to the upper triangle
my.dist2[lower.tri(my.dist2)] = t(my.dist2)[lower.tri(my.dist2)]
diag(my.dist2)<-999 # big number to guarantee it’s not the min
# compare with hclust
test <- hclust(as.dist(my.dist2), method="average") # average linkage, UPGMA
test$merge
test$height
test$order
test$labels<-LETTERS[1:4]
plot(test,hang=-1)
b <- list()
b$merge <- matrix(c(-1, -2,
1, -3,
2, -4), ncol = 2, byrow=TRUE )
b$height <- c(.14, .305, 0.51)    # define merge heights
b$order <- 1:4             # order of leaves(trivial if hand-entered)
b$labels <- LETTERS[1:4]    # labels of leaves
class(b) <- "hclust"        # make it an hclust object
plot(b)                     # look at the result
#convert to a dendrogram object if needed
bd <- as.dendrogram(b)
b <- list()
b$merge <- matrix(c(-1, -2,
1, -3,
2, -4), ncol = 2, byrow=TRUE )
b$height <- c(.14, .305, 0.51)    # define merge heights
b$order <- c(1,2,4,3)            # order of leaves(trivial if hand-entered)
b$labels <- LETTERS[1:4]    # labels of leaves
class(b) <- "hclust"        # make it an hclust object
plot(b)                     # look at the result
#convert to a dendrogram object if needed
bd <- as.dendrogram(b)
b <- list()
b$merge <- matrix(c(-1, -2,
1, -3,
2, -4), ncol = 2, byrow=TRUE )
b$height <- c(.14, .305, 0.51)    # define merge heights
b$order <- 1:4            # order of leaves(trivial if hand-entered)
b$labels <- c("A", "B", "D", "C")    # labels of leaves
class(b) <- "hclust"        # make it an hclust object
plot(b)                     # look at the result
#convert to a dendrogram object if needed
bd <- as.dendrogram(b)
# create matrix
my.dist2 <- matrix(data=rep(0,16),ncol=4)
my.dist2[1,2]<-.14; my.dist2[1,3]<-.48; my.dist2[1,4]<-.33;
my.dist2[2,3]<-.50; my.dist2[2,4]<-.28;
my.dist2[3,4]<-.55;
# make matrix symmetric
# make the lower triangle equal to the upper triangle
my.dist2[lower.tri(my.dist2)] = t(my.dist2)[lower.tri(my.dist2)]
diag(my.dist2)<-999 # big number to guarantee it’s not the min
# compare with hclust
test <- hclust(as.dist(my.dist2), method="average") # average linkage, UPGMA
test$merge
test$height
test$order
test$labels<-LETTERS[1:4]
plot(test,hang=-1)
b <- list()
b$merge <- matrix(c(-1, -2,
1, -3,
2, -4), ncol = 2, byrow=TRUE )
b$height <- c(.14, .305, 0.51)    # define merge heights
b$order <- 1:4            # order of leaves(trivial if hand-entered)
b$labels <- c("A", "B", "D", "C")    # labels of leaves
class(b) <- "hclust"        # make it an hclust object
plot(b)                     # look at the result
#convert to a dendrogram object if needed
bd <- as.dendrogram(b)
# create matrix
my.dist2 <- matrix(data=rep(0,16),ncol=4)
my.dist2[1,2]<-.14; my.dist2[1,3]<-.48; my.dist2[1,4]<-.33;
my.dist2[2,3]<-.50; my.dist2[2,4]<-.28;
my.dist2[3,4]<-.55;
# make matrix symmetric
# make the lower triangle equal to the upper triangle
my.dist2[lower.tri(my.dist2)] = t(my.dist2)[lower.tri(my.dist2)]
diag(my.dist2)<-999 # big number to guarantee it’s not the min
# compare with hclust
test <- hclust(as.dist(my.dist2), method="average") # average linkage, UPGMA
test$merge
test$height
test$order
test$labels<-LETTERS[1:4]
plot(test,hang=-1)
b <- list()
b$merge <- matrix(c(-1, -2,
1, -3,
2, -4), ncol = 2, byrow=TRUE )
b$height <- c(.14, .305, 0.51)    # define merge heights
b$order <- 1:4            # order of leaves(trivial if hand-entered)
b$labels <- c("A", "B", "D", "C")    # labels of leaves
class(b) <- "hclust"        # make it an hclust object
plot(b)                     # look at the result
#convert to a dendrogram object if needed
bd <- as.dendrogram(b)
my.dist2 <- matrix(data=rep(0,16),ncol=4)
my.dist2[1,2]<-.14; my.dist2[1,3]<-.48; my.dist2[1,4]<-.33;
my.dist2[2,3]<-.50; my.dist2[2,4]<-.28;
my.dist2[3,4]<-.55;
# make matrix symmetric
# make the lower triangle equal to the upper triangle
my.dist2[lower.tri(my.dist2)] = t(my.dist2)[lower.tri(my.dist2)]
diag(my.dist2)<-999 # big number to guarantee it’s not the min
# compare with hclust
test <- hclust(as.dist(my.dist2), method="average") # average linkage, UPGMA
test$merge
test$height
test$order
test$labels<-LETTERS[1:4]
plot(test,hang=-1)
locs<-cmdscale(as.dist(my.dist2))
x<-locs[,1]
y<-locs[,2]
# pch=NA hides plot symbols:
plot(x,y,main="Multi-dimensional Scaling",
xlab="MDS dimension-1", ylab="MDS dimension-2", pch=NA,asp=1)
# pch specifies plot symbol; we want null because we are using letter next
# plot the text labels instead of symbols:
text(x,y,test$labels,cex=1)
